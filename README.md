# ğŸ—“ í¬ì»·ì¸ ì§‘ (4cuts.zip)
## âœŒğŸ» ë„¤ì»· ì‚¬ì§„ê³¼ ê´€ë ¨ëœ í¬í† ë¶€ìŠ¤, í¬ì¦ˆ ë“±ì„ í•¨ê»˜ ê³µìœ í•˜ëŠ” SNS ì•±
##### í”„ë¡œì íŠ¸ ê¸°ê°„: 2024ë…„ 8ì›” 25ì¼ â†’ 2024ë…„ 9ì›” 3ì¼ (10ì¼)
##### ì¸ì›: ê¸°íš & ë””ìì¸ & ê°œë°œ ì´ 1ëª…
##### ìµœì†Œ ë²„ì „: iOS 17+

## ğŸ§ í•µì‹¬ ê¸°ëŠ¥
* í¬í† ë¶€ìŠ¤, ë°°ê²½ ë° í•„í„°, í¬ì¦ˆ ê³µìœ 
* ë„¤ì»· ì‚¬ì§„ í¬ìŠ¤íŠ¸
* ê·¼ì²˜ì— ìˆëŠ” í¬í† ë¶€ìŠ¤ ìœ„ì¹˜ í‘œì‹œ
* ë„¤ì»·ì‚¬ì§„ê³¼ ê´€ë ¨ëœ ìƒí’ˆ ê²°ì œ

## ğŸ¤“ ê¸°ìˆ  ìŠ¤íƒ
* UIKit, RxSwift, RxCocoa
* MVVM - InOut, Router íŒ¨í„´
* CoreLocation

## ğŸ“š ë¼ì´ë¸ŒëŸ¬ë¦¬
* NaverMapSDK
* Alamofire
* iamport_ios
* SnapKit
* Kingfisher
* Toast

## ğŸ’¡ ë¬¸ì œ í•´ê²°

### â“ í† í”½
**í† í°ì„ ì‚¬ìš©í•˜ëŠ” APIì—ì„œ í† í° ë§Œë£Œ ì‹œ ë¦¬í”„ë ˆì‹œ í† í°ìœ¼ë¡œ í† í° ê°±ì‹ , ë¦¬í”„ë ˆì‹œ í† í° ë§Œë£Œ ì‹œ ëŒ€ì‘**

### â• í•´ê²° ë°©ë²•


ğŸ’¡ **ë¬¸ì œìƒí™©**: **í† í° ë§Œë£Œ ì‹œ ì„œë²„ì— ìš”ì²­ì„ ë³´ë‚´ê¸° ì „ì—, ì¤‘ê°„ì— ê°€ë¡œì±„ ì‘ì—…í•œ ë’¤ ë‹¤ì‹œ ì„œë²„ë¡œ ë³´ë‚´ëŠ” Interceptorë¥¼ í™œìš©í•˜ì—¬ retry ë©”ì„œë“œë¡œ ê°±ì‹ í•˜ë ¤ í–ˆìœ¼ë‚˜, retry ë©”ì„œë“œê°€ ë¬´í•œ ì‹¤í–‰ë˜ëŠ” ë¬¸ì œ ë°œìƒ â†’ ì–´ë–»ê²Œ ë¬´í•œ ì‹¤í–‰ì„ ë©ˆì¶”ê³  í† í° ê°±ì‹ ì„ í•  ìˆ˜ ìˆì„ê¹Œ?**

- Router íŒ¨í„´ & TargetType ì ìš©ìœ¼ë¡œ Routerë¥¼ í†µí•´ ë§Œë£Œëœ í† í°ì´ í¬í•¨ëœ Requestë¥¼ ì ìš©í•˜ê³  ìˆìŒ
    - retry ë©”ì„œë“œì˜ requestëŠ” í† í° ê°±ì‹  ì „ì˜ requestë¥¼ ê°€ì ¸ì˜¤ê¸° ë•Œë¬¸ì—
    - adapt ë©”ì„œë“œì— request Headerì— ê°±ì‹ ëœ í† í°ì˜ ì •ë³´ë¥¼ ë„£ì–´ì£¼ê³  retry ë©”ì„œë“œë¥¼ ì‹¤í–‰ì‹œì¼œì•¼ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•¨
- ë¦¬í”„ë ˆì‹œ í† í°ê¹Œì§€ ë§Œë£Œë˜ë©´ ì €ì¥ë˜ì–´ ìˆë˜ ëª¨ë“  ì •ë³´ë¥¼ ì‚­ì œí•˜ê³ , ë¡œê·¸ì¸ í™”ë©´ì„ ë„ì›Œ
    - ì •ìƒì ì¸ ë¡œê·¸ì¸ì´ ê°€ëŠ¥í•˜ë‹¤ë©´ í† í°ê³¼, ë¦¬í”„ë ˆì‹œ í† í°ì„ ë°œê¸‰ë°›ì„ ìˆ˜ ìˆë„ë¡ ëŒ€ì‘
 <img width="1000" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2024-09-17 á„‹á…©á„’á…® 1 25 50" src="https://github.com/user-attachments/assets/e693979d-4565-4cb0-9653-087beddffc4c">


------
### â“ í† í”½
**PG ê²°ì œ í”Œë¡œìš°ì™€ ì˜ìˆ˜ì¦ ê²€ì¦**

### â• í•´ê²° ë°©ë²•
ğŸ’¡ **ë¬¸ì œìƒí™©:** **ë„¤ì»· ì‚¬ì§„ê³¼ ê´€ë ¨ëœ ìƒí’ˆì„ íŒë§¤í•˜ê³  ì‹¶ì€ë° ì–´ë–»ê²Œ ê²°ì œ ì‹œìŠ¤í…œì„ ì ìš©ì‹œí‚¤ê³  ì‹¤ì œ ê²°ì œê°€ ì¼ì–´ë‚¬ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆì„ê¹Œ?**

- í†µí•© ê²°ì œ APIì¸ í¬íŠ¸ì›ì„ í™œìš©í•˜ì—¬ ê²°ì œëŒ€í–‰ì‚¬(PG) ì—°ê²°
    - ê²°ì œ ë²„íŠ¼ì„ íƒ­í–ˆì„ ë•Œ ê²°ì œ ì •ë³´ ì…ë ¥
    
    ```swift
    input.payTap
            .subscribe(with: self) { owner, value in
                let payment = IamportPayment(
                    pg: PG.html5_inicis.makePgRawName(pgId: "INIpayTest"),
                    merchant_uid: "ios_\(APIKey.sesacKey)_\(Int(Date().timeIntervalSince1970))",
                    amount: "\(value.1)").then {
                        $0.pay_method = PayMethod.card.rawValue
                        $0.name = "4cut.zip"
                        $0.buyer_name = "ì–‘ë³´ë¼"
                        $0.app_scheme = "sesac"
                    }
                outputPayment.onNext((payment, value.0))
            }
            .disposed(by: disposeBag)
    ```
    
- ì‹¤ì œ ê²°ì œê°€ ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´
    - ê²°ì œ ì •ë³´ë¥¼ ê°€ì§€ê³  ì˜ìˆ˜ì¦ ê²€ì¦ì„ í†µí•´ ì‹¤ì œ ê²°ì œ ë‚´ì—­ì´ ìˆëŠ”ì§€ í™•ì¸ í›„
    - ìœ ì €ì—ê²Œ í† ìŠ¤íŠ¸ ë©”ì‹œì§€ë¥¼ ë„ì›Œ ì£¼ê³  ë¡œì§ì„ ì²˜ë¦¬
```swift
output.payment
            .subscribe(with: self) { owner, payment in
                Iamport.shared.payment(viewController: owner,
                                       userCode: "imp57573124",
                                       payment: payment.0) { paymentResult in
                    NetworkManager.shared.validPayment(impUid: paymentResult.imp_uid, postId: payment.1) { value in
                        switch value {
                        case .success(let success):
                            owner.makeToast(title: "ê²°ì œ", message: "ê²°ì œê°€ ì™„ë£Œë˜ì—ˆì–´ìš”!")
                        case .failure(let failure):
                            self.view.makeToast("ê²°ì œê°€ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤")
                        }
                    }
                }
            }
            .disposed(by: disposeBag)
```
---
       
### â“ í† í”½
**ì‚¬ìš©ìì˜ ì•„ì´í° ìì²´ì˜ ìœ„ì¹˜ì„œë¹„ìŠ¤ê°€ êº¼ì ¸ìˆê±°ë‚˜, ì•±ì˜ ìœ„ì¹˜ì„œë¹„ìŠ¤ë¥¼ í—ˆìš©í•˜ì§€ ì•Šì€ ìƒíƒœì˜ ëŒ€ì‘**

### â• í•´ê²° ë°©ë²•

ğŸ’¡ **ë¬¸ì œ ìƒí™©**: **CoreLocationì„ í™œìš©í•˜ì—¬ ì‚¬ìš©ìì˜ ìœ„ì¹˜ë¥¼ ë°›ì•„ì™€ ì£¼ë³€ì˜ í¬í† ë¶€ìŠ¤ë“¤ì„ í‘œì‹œí•´ ì£¼ê³  ì‹¶ì€ë° ìœ„ì¹˜ ì„œë¹„ìŠ¤ ìƒíƒœì— ë”°ë¼ ì•±ì´ ê·¸ëƒ¥ êº¼ì§€ê¸°ë„ í•˜ì—¬ ìƒì„¸í•˜ê³  ì ì ˆí•œ ëŒ€ì‘ì´ í•„ìš”í•˜ê³ , ì•±ì„ ì‚¬ìš©í•˜ë‹¤ê°€ ì„¤ì •ì˜ ë³€ê²½ê¹Œì§€ í™•ì¸í•˜ì—¬ ëŒ€ì‘í•´ì•¼ í•˜ì§€ ì•Šì„ê¹Œ?**

- ì–´ë– í•œ ì´ìœ ë¡œ í˜„ì¬ ìœ„ì¹˜ê°€ ëœ¨ì§€ ì•ŠëŠ”ì§€ì— ëŒ€í•œ ìì„¸í•œ ì´ìœ ë¥¼ í† ìŠ¤íŠ¸ ë©”ì„¸ì§€ë¡œ ë„ì›Œì£¼ê³ 
- ë””í´íŠ¸ ì£¼ì†Œë¥¼ ì„¤ì •í•˜ì—¬ ì§€ë„ë¥¼ ë„ì›Œì¤Œ
<img width="1000" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2024-09-17 á„‹á…©á„’á…® 1 25 58" src="https://github.com/user-attachments/assets/23319c53-5390-42a7-8d49-c3d617ba73c7">


---
### â“ í† í”½
**Createì™€ Updateë¥¼ í•œ ë©”ì„œë“œì—ì„œ ì²˜ë¦¬í•˜ê¸°**

### â• í•´ê²° ë°©ë²•

ğŸ’¡ **ë¬¸ì œ ìƒí™©**: **ê¸€ì„ í¬ìŠ¤íŠ¸ í•˜ê±°ë‚˜, ìˆ˜ì •í•˜ëŠ” ë¡œì§ì„ í•œ í™”ë©´ì—ì„œ êµ¬í˜„í•˜ê¸° ë•Œë¬¸ì— ì—…ë¡œë“œ ë²„íŠ¼ì´ tap ë˜ì—ˆì„ ë•Œ multipartFormData íƒ€ì…ìœ¼ë¡œ ì´ë¯¸ì§€ë¥¼ ì˜¬ë¦¬ëŠ” ê²ƒê¹Œì§€ëŠ” ë™ì¼í•˜ë‚˜ ë„¤íŠ¸ì›Œí‚¹ í•˜ëŠ” ë¶€ë¶„ë¶€í„° ë¶„ê¸°ì²˜ë¦¬ê°€ í•„ìš”í•œë° ì–´ë–»ê²Œ ìµœì†Œí•œì˜ ì½”ë“œë¡œ ë‘ ê°€ì§€ ë¡œì§ì„ ëŒ€ì‘í•  ìˆ˜ ìˆì„ê¹Œ?**

- ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ëŠ” ë„¤íŠ¸ì›Œí‚¹ì„ ì‹¤í–‰í•˜ê³  ì‹¤íŒ¨í–ˆì„ ë•ŒëŠ” ì´ë¯¸ì§€ ì—…ë¡œë“œ ì‹¤íŒ¨ì— ëŒ€í•œ í† ìŠ¤íŠ¸ ë©”ì‹œì§€ë¥¼ í‘œì‹œí•˜ê³  ì„±ê³µí–ˆì„ ë•ŒëŠ”
    - Updateì˜ ê²½ìš°ì—ëŠ” ì´ë¯¸ PostIdë¥¼ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì—
    - PostId ìœ ë¬´ë¡œ ë¶„ê¸°ì²˜ë¦¬í•˜ì—¬ ê°ê°ì˜ ë¼ìš°í„°ì˜ requestë¡œ ë„¤íŠ¸ì›Œí‚¹ ì²˜ë¦¬ë¡œ
    - í•œ ë©”ì„œë“œë¡œ ë‘ ê°€ì§€ ë¡œì§ ëŒ€ì‘
```swift
input.uploadButtonTap
            .subscribe(with: self) { owner, contentValue in
                let imageContents = contentValue.0
                let stringContent = contentValue.1
                let postId = contentValue.2

                do {
                    AF.upload(multipartFormData: { multipartFormData in
                        imageContents.forEach { image in
                                if let convertedImage = image.jpegData(compressionQuality: 0.1) {
                                multipartFormData.append(convertedImage, withName: "files", fileName: "\(stringContent).png", mimeType: "image/png")
                            }
                        }
                    }, with: try Router.uploadPhoto.asURLRequest())
                    .responseDecodable(of: PhotoListModel.self) { [weak self] response in
                        guard let self else { return }
                        switch response.result {
                        case .success(let value):
                            Observable.just(value)
                                .flatMap { photo -> Single<Result<PostContent, NetworkError>> in
                                    if let id = postId {
                                        NetworkManager.shared.callRequestWithToken(router: .editPost(id: id, content: Content(content: stringContent, product_id: "4cut_photo", files: photo.files)))
                                    } else {
                                        NetworkManager.shared.callRequestWithToken(router: .postContent(content: Content(content: stringContent, product_id: "4cut_photo", files: photo.files)))
                                    }
                                }
                                .subscribe(with: self, onNext: { owner, value in
                                    switch value {
                                    case .success:
                                        owner.popNavi.onNext(true)
                                    case .failure:
                                        failUploadString.onNext(true)
                                    }
                                })
                                .disposed(by: self.disposeBag)
                        case .failure:
                            failUploadImage.onNext(true)
                        }
                    }
                } catch {
                    failNetworking.onNext(true)
                }

            }
            .disposed(by: disposeBag)
```
